{"version":3,"sources":["../src/publication.js"],"names":["define","$","Str","Ajax","ACTION","PUBLICATION_BUTTON","ALUMN_SELECT","GROUP_SELECT","TEXT","COMMENT_TEXT","SERVICES","MODULE_PUBLICATION","Publication","region","courseId","courseid","node","find","on","onAlumnSelectChange","bind","onGroupSelectChange","onCommentTextKeyUp","onPublicationButtonClick","prototype","val","trim","prop","comment","student","group","mode","item","parseInt","request","methodname","args","course_id","call","done","location","reload","fail","Notification","exception","initPublication"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package theme_cbe\n * @author  2021 3iPunt <https://www.tresipunt.com/>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n\ndefine([\n        'jquery',\n        'core/str',\n        'core/ajax',\n        'core/templates'\n    ], function ($, Str, Ajax, Templates) {\n        \"use strict\";\n\n        /**\n         *\n         */\n        let ACTION = {\n            PUBLICATION_BUTTON: '[data-action=\"publicate\"]',\n            ALUMN_SELECT: '[data-action=\"alumn\"]',\n            GROUP_SELECT: '[data-action=\"group\"]',\n        };\n\n        let TEXT = {\n            COMMENT_TEXT: '[data-text=\"comment\"]',\n        };\n\n        /**\n         *\n         */\n        let SERVICES = {\n            MODULE_PUBLICATION: 'theme_cbe_publication'\n        };\n\n        /**\n         * @constructor\n         * @param {String} region\n         * @param {Number} courseId\n         */\n        function Publication(region, courseId) {\n            this.courseid = courseId;\n            this.node = $(region);\n            this.node.find(ACTION.ALUMN_SELECT).on('change', this.onAlumnSelectChange.bind(this));\n            this.node.find(ACTION.GROUP_SELECT).on('change', this.onGroupSelectChange.bind(this));\n            this.node.find(TEXT.COMMENT_TEXT).on('keyup', this.onCommentTextKeyUp.bind(this));\n            this.node.find(ACTION.PUBLICATION_BUTTON).on('click', this.onPublicationButtonClick.bind(this));\n        }\n\n        Publication.prototype.onCommentTextKeyUp = function (e) {\n            if (this.node.find(TEXT.COMMENT_TEXT).val().trim() !== '') {\n                $(ACTION.PUBLICATION_BUTTON).prop( \"disabled\", false );\n            } else {\n                $(ACTION.PUBLICATION_BUTTON).prop( \"disabled\", true );\n            }\n        };\n\n        Publication.prototype.onAlumnSelectChange = function (e) {\n            this.node.find(ACTION.GROUP_SELECT).val(0);\n        };\n\n        Publication.prototype.onGroupSelectChange = function (e) {\n            this.node.find(ACTION.ALUMN_SELECT).val(0);\n        };\n\n        Publication.prototype.onPublicationButtonClick = function (e) {\n            $(ACTION.PUBLICATION_BUTTON).prop( \"disabled\", true );\n            var comment = $(TEXT.COMMENT_TEXT).val();\n            var student = this.node.find(ACTION.ALUMN_SELECT).val();\n            var group = this.node.find(ACTION.GROUP_SELECT).val();\n            var mode = 'all';\n            var item = 0;\n            if (student > 0) {\n                mode = 'student';\n                item = parseInt(student);\n            }\n            if (group > 0) {\n                mode = 'group';\n                item = parseInt(group);\n            }\n            var request = {\n                methodname: SERVICES.MODULE_PUBLICATION,\n                args: {\n                    course_id: this.courseid,\n                    comment: comment,\n                    mode: mode,\n                    item: item\n                }\n            };\n            Ajax.call([request])[0].done(function(response) {\n                location.reload();\n            }).fail(Notification.exception);\n        };\n\n        /** @type {jQuery} The jQuery node for the region. */\n        Publication.prototype.node = null;\n\n        return {\n            /**\n             * @param {String} region\n             * @param {Number} courseId\n             * @return {Publication}\n             */\n            initPublication: function (region, courseId) {\n                return new Publication(region, courseId);\n            }\n        };\n    }\n);"],"file":"publication.min.js"}