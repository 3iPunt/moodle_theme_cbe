/**
 *
 * @author  2021 3iPunt <https://www.tresipunt.com/>
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_cbe/comment_send",["jquery","core/str","core/ajax","core/templates"],(function($,Str,Ajax,Templates){var ACTION_SEND_BUTTON='[data-action="send-comment"]',TEXT_SEND_TEXT='[data-text="comment"]',SERVICES_PUBLICATION_SEND="theme_cbe_publication_comment_send";function CommentSend(region,cmid){this.cmid=cmid,this.node=$(region),this.text=TEXT_SEND_TEXT+'[data-cmid="'+cmid+'"]',this.send_button=ACTION_SEND_BUTTON+'[data-cmid="'+cmid+'"]',this.node.find(this.text).on("keyup",this.onTextChange.bind(this)),this.node.find(this.send_button).on("click",this.onSendButtonClick.bind(this))}return CommentSend.prototype.onTextChange=function(e){""!==this.node.find(this.text).val().trim()?(this.node.find(this.send_button).show(),13===e.keyCode&&this.onSendButtonClick(this)):this.node.find(this.send_button).hide()},CommentSend.prototype.onSendButtonClick=function(e){var comment=this.node.find(this.text).val();this.node.find(this.text).val(""),this.node.find(this.send_button).hide();var request={methodname:SERVICES_PUBLICATION_SEND,args:{cmid:this.cmid,comment:comment}};Ajax.call([request])[0].done((function(response){response.success?(location.href=response.url,setTimeout((function(){window.location.reload(!0)}),1e3)):alert(response.error)})).fail(Notification.exception)},CommentSend.prototype.node=null,{initCommentSend:function(region,cmid){return new CommentSend(region,cmid)}}}));

//# sourceMappingURL=comment_send.min.js.map