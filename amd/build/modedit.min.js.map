{"version":3,"file":"modedit.min.js","sources":["../src/modedit.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *\n * @author  2021 3iPunt <https://www.tresipunt.com/>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n\ndefine([\n        'jquery',\n    ], function ($) {\n        \"use strict\";\n\n        let BUTTONS = {\n            SUBMIT_1 : '#id_submitbutton',\n            SUBMIT_2 : '#id_submitbutton2',\n        };\n\n        let REGIONS = {\n            ALERTS: '.form-control-feedback',\n            ALERT_CBE: '#alert-cbe-modedit',\n        };\n\n        /**\n         * @constructor\n         */\n        function Modedit() {\n            let $create_file_nextcloud = $('#create_file_nextcloud');\n            let $fitem_id_introattachments = $('#fitem_id_introattachments');\n            let $fitem_id_files = $('#fitem_id_files');\n            if ( $fitem_id_introattachments.length > 0 ) {\n                $create_file_nextcloud.prependTo('#fitem_id_introattachments');\n            } else if ($fitem_id_files.length > 0) {\n                $create_file_nextcloud.prependTo('#fitem_id_files');\n            }\n            let mform = $('.mform');\n            this.alertRestriction();\n            mform.find(BUTTONS.SUBMIT_1).on('click', this.alertRestriction.bind(this));\n            mform.find(BUTTONS.SUBMIT_2).on('click', this.alertRestriction.bind(this));\n            mform.find(BUTTONS.SUBMIT_1).on('click', this.alertRestrictionName.bind(this));\n            mform.find(BUTTONS.SUBMIT_2).on('click', this.alertRestrictionName.bind(this));\n        }\n\n        Modedit.prototype.alertRestriction = function (e) {\n            let mform = $('.mform');\n            let alerts = mform.find(REGIONS.ALERTS);\n            let alert_is_visible = false;\n            alerts.each(function(){\n                let $this = $(this);\n                let text = $.trim($this.text());\n                if (text !== '') {\n                    alert_is_visible = true;\n                }\n            });\n            if (alert_is_visible) {\n                let $alert = $(REGIONS.ALERT_CBE);\n                $alert.removeClass('hidden');\n            }\n        };\n\n        Modedit.prototype.alertRestrictionName = function (e) {\n            let alert_is_visible = false;\n            let mform = $('.mform');\n            let $name = mform.find('#id_name');\n            let $id_externalurl = mform.find('#id_externalurl');\n            if ($name.val() === '' || $id_externalurl.val() === '') {\n                alert_is_visible = true;\n            }\n            if (alert_is_visible) {\n                let $alert = $(REGIONS.ALERT_CBE);\n                $alert.removeClass('hidden');\n            }\n        };\n\n        /** @type {jQuery} The jQuery node for the region. */\n        Modedit.prototype.node = null;\n\n        return {\n            /**\n             *\n             * @return {Modedit}\n             */\n            initModedit: function () {\n                return new Modedit();\n            }\n        };\n    }\n);"],"names":["define","$","BUTTONS","REGIONS","Modedit","$create_file_nextcloud","$fitem_id_introattachments","$fitem_id_files","length","prependTo","mform","alertRestriction","find","on","this","bind","alertRestrictionName","prototype","e","alerts","alert_is_visible","each","$this","trim","text","removeClass","$name","$id_externalurl","val","node","initModedit"],"mappings":";;;;;AAwBAA,2BAAO,CACC,WACD,SAAUC,OAGLC,iBACW,mBADXA,iBAEW,oBAGXC,eACQ,yBADRA,kBAEW,8BAMNC,cACDC,uBAAyBJ,EAAE,0BAC3BK,2BAA6BL,EAAE,8BAC/BM,gBAAkBN,EAAE,mBACnBK,2BAA2BE,OAAS,EACrCH,uBAAuBI,UAAU,8BAC1BF,gBAAgBC,OAAS,GAChCH,uBAAuBI,UAAU,uBAEjCC,MAAQT,EAAE,eACTU,mBACLD,MAAME,KAAKV,kBAAkBW,GAAG,QAASC,KAAKH,iBAAiBI,KAAKD,OACpEJ,MAAME,KAAKV,kBAAkBW,GAAG,QAASC,KAAKH,iBAAiBI,KAAKD,OACpEJ,MAAME,KAAKV,kBAAkBW,GAAG,QAASC,KAAKE,qBAAqBD,KAAKD,OACxEJ,MAAME,KAAKV,kBAAkBW,GAAG,QAASC,KAAKE,qBAAqBD,KAAKD,cAG5EV,QAAQa,UAAUN,iBAAmB,SAAUO,OAEvCC,OADQlB,EAAE,UACKW,KAAKT,gBACpBiB,kBAAmB,GACvBD,OAAOE,MAAK,eACJC,MAAQrB,EAAEa,MAED,KADFb,EAAEsB,KAAKD,MAAME,UAEpBJ,kBAAmB,MAGvBA,mBACanB,EAAEE,mBACRsB,YAAY,WAI3BrB,QAAQa,UAAUD,qBAAuB,SAAUE,OAC3CE,kBAAmB,EACnBV,MAAQT,EAAE,UACVyB,MAAQhB,MAAME,KAAK,YACnBe,gBAAkBjB,MAAME,KAAK,oBACb,KAAhBc,MAAME,OAA0C,KAA1BD,gBAAgBC,QACtCR,kBAAmB,GAEnBA,mBACanB,EAAEE,mBACRsB,YAAY,WAK3BrB,QAAQa,UAAUY,KAAO,KAElB,CAKHC,YAAa,kBACF,IAAI1B"}