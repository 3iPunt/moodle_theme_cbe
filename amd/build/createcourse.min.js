define ("theme_cbe/createcourse",["jquery","core/str","core/ajax","core/templates"],function(a,b,c){"use strict";var e={CREATE_BUTTON:"[data-action=\"create\"]"},f={ALL_INPUTS:".validation-input",FULLNAME_INPUT:"#fullname",SHORTNAME_INPUT:"#shortname",CATEGORY_SELECT:"#category",VISIBLE_CHECK:"#visible"},g={SHORTNAME:"[data-msg=\"msg-shortname\"]"},h={FULLNAME_OK:"#verify-fullname .fa-check-circle-o",FULLNAME_KO:"#verify-fullname .fa-times-circle-o",SHORTNAME_OK:"#verify-shortname .fa-check-circle-o",SHORTNAME_KO:"#verify-shortname .fa-times-circle-o",CATEGORY_OK:"#verify-category .fa-check-circle-o",CATEGORY_KO:"#verify-category .fa-times-circle-o"},i={CREATE_COURSE:"theme_cbe_create_course",CHECK_COURSE_SHORTNAME:"theme_cbe_check_course_shortname"},j={fullname:!1,shortname:!1,category:!1};function d(b,c){this.node=a(b);this.has_uniquename=c;this.fullname=f.FULLNAME_INPUT;this.shortname=f.SHORTNAME_INPUT;this.category=f.CATEGORY_SELECT;this.all_inputs=f.ALL_INPUTS;if(!this.has_uniquename){this.node.find(this.fullname).on("change",this.onFullnameChange.bind(this))}else{j.fullname=!0}this.node.find(this.shortname).on("keyup",this.onShortnameChange.bind(this));this.node.find(this.category).on("change",this.onCategoryChange.bind(this));this.node.find(this.all_inputs).on("change",this.onAllInputsChange.bind(this));this.node.find(e.CREATE_BUTTON).on("click",this.onCreateCourseButtonClick.bind(this))}d.prototype.onAllInputsChange=function(){if(j.fullname&&j.shortname&&j.category){a(e.CREATE_BUTTON).prop("disabled",!1)}else{a(e.CREATE_BUTTON).prop("disabled",!0)}};d.prototype.onCategoryChange=function(){if(0<this.node.find(this.category).val().trim()){j.category=!0;a(h.CATEGORY_OK).show();a(h.CATEGORY_KO).hide()}else{j.category=!1;a(h.CATEGORY_OK).hide();a(h.CATEGORY_KO).show()}};d.prototype.onFullnameChange=function(){if(""!==this.node.find(this.fullname).val().trim()){j.fullname=!0;a(h.FULLNAME_OK).show();a(h.FULLNAME_KO).hide()}else{j.fullname=!1;a(h.FULLNAME_KO).show();a(h.FULLNAME_OK).hide()}};d.prototype.onShortnameChange=function(){var b=a(f.SHORTNAME_INPUT).val().trim();if(3<this.node.find(this.shortname).val().length){var d={methodname:i.CHECK_COURSE_SHORTNAME,args:{shortname:b}};c.call([d])[0].done(function(b){if(b.exist){j.shortname=!1;a(g.SHORTNAME).text(b.msg);a(h.SHORTNAME_KO).show();a(h.SHORTNAME_OK).hide();if(j.fullname&&j.shortname&&j.category){a(e.CREATE_BUTTON).prop("disabled",!1)}else{a(e.CREATE_BUTTON).prop("disabled",!0)}}else{a(h.SHORTNAME_OK).show();a(h.SHORTNAME_KO).hide();a(g.SHORTNAME).text("");j.shortname=!0;if(j.fullname&&j.shortname&&j.category){a(e.CREATE_BUTTON).prop("disabled",!1)}else{a(e.CREATE_BUTTON).prop("disabled",!0)}}}).fail(Notification.exception)}else{j.shortname=!1;a(h.SHORTNAME_KO).show();a(h.SHORTNAME_OK).hide()}};d.prototype.onCreateCourseButtonClick=function(){a(e.CREATE_BUTTON).prop("disabled",!0);var b="";if(!this.has_uniquename){b=a(f.FULLNAME_INPUT).val().trim()}else{b=a(f.SHORTNAME_INPUT).val().trim()}var d=a(f.SHORTNAME_INPUT).val().trim(),g=a(f.CATEGORY_SELECT).val(),h=a(f.VISIBLE_CHECK).is(":checked")?1:0,j={methodname:i.CREATE_COURSE,args:{fullname:b,shortname:d,category:g,visible:h}};c.call([j])[0].done(function(a){if(a.success){location.href=a.redirect}else{alert(a.error)}}).fail(Notification.exception)};d.prototype.node=null;return{initCreateCourse:function initCreateCourse(a,b){return new d(a,b)}}});
//# sourceMappingURL=createcourse.min.js.map
