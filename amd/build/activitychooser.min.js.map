{"version":3,"file":"activitychooser.min.js","sources":["../src/activitychooser.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *\n * @author 2021 3iPunt <https://www.tresipunt.com/>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n\ndefine([\n        'jquery',\n        'core/str',\n        'core/ajax',\n        'core/templates'\n    ], function ($, Str, Ajax, Templates) {\n        \"use strict\";\n\n        /**\n         *\n         */\n        let REGIONS = {\n            RESOURCES_TAB: '[data-region=\"resources-tab-nav\"]',\n            RESOURCES_CONTENT: '[data-region=\"resources\"]',\n            ACTIVITY_TAB: '[data-region=\"activity-tab-nav\"]',\n            ACTIVITY_CONTENT: '[data-region=\"activity\"]',\n            FAVOURITE_TAB: '[data-region=\"favourite-tab-nav\"]',\n            FAVOURITE_CONTENT: '[data-region=\"favourites\"]',\n            RECOMMENDED_TAB: '[data-region=\"recommended-tab-nav\"]',\n            RECOMMENDED_CONTENT: '[data-region=\"recommended\"]'\n        };\n\n        /**\n         *\n         */\n        let ORDER = {\n            'favourite-tab-nav': 0,\n            'recommended-tab-nav': 1,\n            'activity-tab-nav': 2,\n            'resources-tab-nav': 3,\n            'default-tab-nav': 4,\n        };\n\n        /**\n         * @constructor\n         * @param {String} region\n         */\n        function ActivityChooser(region) {\n            this.node = $(region);\n            this.order();\n            this.refresh();\n            window.setInterval(() => this.refresh(), 500);\n            this.node.find(REGIONS.RECOMMENDED_TAB).on('click', this.refresh.bind(this));\n            this.node.find(REGIONS.RESOURCES_TAB).on('click', this.refresh.bind(this));\n            this.node.find(REGIONS.ACTIVITY_TAB).on('click', this.refresh.bind(this));\n            this.node.find(REGIONS.FAVOURITE_TAB).on('click', this.refresh.bind(this));\n            this.node.find('[data-action=\"manage-module-favourite\"]')\n                .on('click', this.refresh.bind(this));\n        }\n\n        ActivityChooser.prototype.refresh = function (e) {\n            let recommended_tab = this.node.find(REGIONS.RECOMMENDED_TAB);\n            let recommended_content = this.node.find(REGIONS.RECOMMENDED_CONTENT);\n            let favourite_tab = this.node.find(REGIONS.FAVOURITE_TAB);\n            let favourite_content = this.node.find(REGIONS.FAVOURITE_CONTENT);\n            let activity_tab = this.node.find(REGIONS.ACTIVITY_TAB);\n            let resources_tab = this.node.find(REGIONS.RESOURCES_TAB);\n            let all_tabs = this.node.find('.chooser-container .nav.nav-tabs .nav-item.nav-link');\n            let all_contents = this.node.find('.chooser-container .tab-pane');\n\n            if ( !activity_tab.hasClass('active') && !resources_tab.hasClass('active')) {\n                if ( !favourite_tab.hasClass('d-none') ) {\n                    all_tabs.removeClass('active');\n                    all_contents.removeClass('active');\n                    favourite_tab.addClass('active');\n                    favourite_content.addClass('active');\n                    recommended_tab.hide();\n                } else {\n                    if ( !recommended_tab.hasClass('d-none') ) {\n                        recommended_tab.show();\n                        all_tabs.removeClass('active');\n                        all_contents.removeClass('active');\n                        recommended_tab.addClass('active');\n                        recommended_content.addClass('active');\n                    }\n                }\n            } else {\n                if ( !favourite_tab.hasClass('d-none') ) {\n                    recommended_tab.hide();\n                } else {\n                    if ( !recommended_tab.hasClass('d-none') ) {\n                        recommended_tab.show();\n                    }\n                }\n            }\n        };\n\n        ActivityChooser.prototype.order = function (e) {\n            $('.chooser-container .nav.nav-tabs').each(function(){\n                let $this = $(this);\n                $this.append($this.find('.nav-item.nav-link').get().sort(function(a, b) {\n                    let region_a = $(a).data('region');\n                    let region_b = $(b).data('region');\n                    return ORDER[region_a] - ORDER[region_b];\n                }));\n            });\n        };\n\n        /** @type {jQuery} The jQuery node for the region. */\n        ActivityChooser.prototype.node = null;\n\n        return {\n            /**\n             * @param {String} region\n             *\n             * @return {ActivityChooser}\n             */\n            initActivityChooser: function (region) {\n                return new ActivityChooser(region);\n            }\n        };\n    }\n);"],"names":["define","$","Str","Ajax","Templates","REGIONS","ORDER","ActivityChooser","region","node","order","refresh","window","setInterval","_this","find","on","this","bind","prototype","e","recommended_tab","recommended_content","favourite_tab","favourite_content","activity_tab","resources_tab","all_tabs","all_contents","hasClass","show","hide","removeClass","addClass","each","$this","append","get","sort","a","b","region_a","data","region_b","initActivityChooser"],"mappings":";;;;;AAwBAA,mCAAO,CACC,SACA,WACA,YACA,mBACD,SAAUC,EAAGC,IAAKC,KAAMC,eAMnBC,sBACe,oCADfA,qBAGc,mCAHdA,sBAKe,oCALfA,0BAMmB,6BANnBA,wBAOiB,sCAPjBA,4BAQqB,8BAMrBC,MAAQ,qBACa,wBACE,qBACH,sBACC,oBACF,YAOdC,gBAAgBC,4BAChBC,KAAOR,EAAEO,aACTE,aACAC,UACLC,OAAOC,aAAY,kBAAMC,MAAKH,YAAW,UACpCF,KAAKM,KAAKV,yBAAyBW,GAAG,QAASC,KAAKN,QAAQO,KAAKD,YACjER,KAAKM,KAAKV,uBAAuBW,GAAG,QAASC,KAAKN,QAAQO,KAAKD,YAC/DR,KAAKM,KAAKV,sBAAsBW,GAAG,QAASC,KAAKN,QAAQO,KAAKD,YAC9DR,KAAKM,KAAKV,uBAAuBW,GAAG,QAASC,KAAKN,QAAQO,KAAKD,YAC/DR,KAAKM,KAAK,2CACVC,GAAG,QAASC,KAAKN,QAAQO,KAAKD,cAGvCV,gBAAgBY,UAAUR,QAAU,SAAUS,OACtCC,gBAAkBJ,KAAKR,KAAKM,KAAKV,yBACjCiB,oBAAsBL,KAAKR,KAAKM,KAAKV,6BACrCkB,cAAgBN,KAAKR,KAAKM,KAAKV,uBAC/BmB,kBAAoBP,KAAKR,KAAKM,KAAKV,2BACnCoB,aAAeR,KAAKR,KAAKM,KAAKV,sBAC9BqB,cAAgBT,KAAKR,KAAKM,KAAKV,uBAC/BsB,SAAWV,KAAKR,KAAKM,KAAK,uDAC1Ba,aAAeX,KAAKR,KAAKM,KAAK,gCAE5BU,aAAaI,SAAS,WAAcH,cAAcG,SAAS,UAiBvDN,cAAcM,SAAS,UAGnBR,gBAAgBQ,SAAS,WAC3BR,gBAAgBS,OAHpBT,gBAAgBU,OAjBdR,cAAcM,SAAS,UAOnBR,gBAAgBQ,SAAS,YAC3BR,gBAAgBS,OAChBH,SAASK,YAAY,UACrBJ,aAAaI,YAAY,UACzBX,gBAAgBY,SAAS,UACzBX,oBAAoBW,SAAS,YAXjCN,SAASK,YAAY,UACrBJ,aAAaI,YAAY,UACzBT,cAAcU,SAAS,UACvBT,kBAAkBS,SAAS,UAC3BZ,gBAAgBU,SAqB5BxB,gBAAgBY,UAAUT,MAAQ,SAAUU,GACxCnB,EAAE,oCAAoCiC,MAAK,eACnCC,MAAQlC,EAAEgB,MACdkB,MAAMC,OAAOD,MAAMpB,KAAK,sBAAsBsB,MAAMC,MAAK,SAASC,EAAGC,OAC7DC,SAAWxC,EAAEsC,GAAGG,KAAK,UACrBC,SAAW1C,EAAEuC,GAAGE,KAAK,iBAClBpC,MAAMmC,UAAYnC,MAAMqC,kBAM3CpC,gBAAgBY,UAAUV,KAAO,KAE1B,CAMHmC,oBAAqB,SAAUpC,eACpB,IAAID,gBAAgBC"}