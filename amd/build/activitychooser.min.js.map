{"version":3,"sources":["../src/activitychooser.js"],"names":["define","$","REGIONS","RESOURCES_TAB","RESOURCES_CONTENT","ACTIVITY_TAB","ACTIVITY_CONTENT","FAVOURITE_TAB","FAVOURITE_CONTENT","RECOMMENDED_TAB","RECOMMENDED_CONTENT","ORDER","ActivityChooser","region","node","order","refresh","window","setInterval","find","on","bind","prototype","recommended_tab","recommended_content","favourite_tab","favourite_content","activity_tab","resources_tab","all_tabs","all_contents","hasClass","removeClass","addClass","hide","show","each","$this","append","get","sort","a","b","region_a","data","region_b","initActivityChooser"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package theme_cbe\n * @author 2021 3iPunt <https://www.tresipunt.com/>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n\ndefine([\n        'jquery',\n        'core/str',\n        'core/ajax',\n        'core/templates'\n    ], function ($, Str, Ajax, Templates) {\n        \"use strict\";\n\n        /**\n         *\n         */\n        let REGIONS = {\n            RESOURCES_TAB: '[data-region=\"resources-tab-nav\"]',\n            RESOURCES_CONTENT: '[data-region=\"resources\"]',\n            ACTIVITY_TAB: '[data-region=\"activity-tab-nav\"]',\n            ACTIVITY_CONTENT: '[data-region=\"activity\"]',\n            FAVOURITE_TAB: '[data-region=\"favourite-tab-nav\"]',\n            FAVOURITE_CONTENT: '[data-region=\"favourites\"]',\n            RECOMMENDED_TAB: '[data-region=\"recommended-tab-nav\"]',\n            RECOMMENDED_CONTENT: '[data-region=\"recommended\"]'\n        };\n\n        /**\n         *\n         */\n        let ORDER = {\n            'favourite-tab-nav': 0,\n            'recommended-tab-nav': 1,\n            'activity-tab-nav': 2,\n            'resources-tab-nav': 3,\n            'default-tab-nav': 4,\n        };\n\n        /**\n         * @constructor\n         * @param {String} region\n         */\n        function ActivityChooser(region) {\n            this.node = $(region);\n            this.order();\n            this.refresh();\n            window.setInterval(() => this.refresh(), 500);\n            this.node.find(REGIONS.RECOMMENDED_TAB).on('click', this.refresh.bind(this));\n            this.node.find(REGIONS.RESOURCES_TAB).on('click', this.refresh.bind(this));\n            this.node.find(REGIONS.ACTIVITY_TAB).on('click', this.refresh.bind(this));\n            this.node.find(REGIONS.FAVOURITE_TAB).on('click', this.refresh.bind(this));\n            this.node.find('[data-action=\"manage-module-favourite\"]')\n                .on('click', this.refresh.bind(this));\n        }\n\n        ActivityChooser.prototype.refresh = function (e) {\n\n            let recommended_tab = this.node.find(REGIONS.RECOMMENDED_TAB);\n            let recommended_content = this.node.find(REGIONS.RECOMMENDED_CONTENT);\n            let favourite_tab = this.node.find(REGIONS.FAVOURITE_TAB);\n            let favourite_content = this.node.find(REGIONS.FAVOURITE_CONTENT);\n            let activity_tab = this.node.find(REGIONS.ACTIVITY_TAB);\n            let resources_tab = this.node.find(REGIONS.RESOURCES_TAB);\n            let all_tabs = this.node.find('.chooser-container .nav.nav-tabs .nav-item.nav-link');\n            let all_contents = this.node.find('.chooser-container .tab-pane');\n\n            if ( !activity_tab.hasClass('active') && !resources_tab.hasClass('active')) {\n                if ( !favourite_tab.hasClass('d-none') ) {\n                    all_tabs.removeClass('active');\n                    all_contents.removeClass('active');\n                    favourite_tab.addClass('active');\n                    favourite_content.addClass('active');\n                    recommended_tab.hide();\n                } else {\n                    if ( !recommended_tab.hasClass('d-none') ) {\n                        recommended_tab.show();\n                        all_tabs.removeClass('active');\n                        all_contents.removeClass('active');\n                        recommended_tab.addClass('active');\n                        recommended_content.addClass('active');\n                    }\n                }\n            } else {\n                if ( !favourite_tab.hasClass('d-none') ) {\n                    recommended_tab.hide();\n                } else {\n                    if ( !recommended_tab.hasClass('d-none') ) {\n                        recommended_tab.show();\n                    }\n                }\n            }\n\n\n        };\n\n    ActivityChooser.prototype.order = function (e) {\n\n        $('.chooser-container .nav.nav-tabs').each(function(){\n            let $this = $(this);\n            $this.append($this.find('.nav-item.nav-link').get().sort(function(a, b) {\n                let region_a = $(a).data('region');\n                let region_b = $(b).data('region');\n                return ORDER[region_a] - ORDER[region_b];\n            }));\n        });\n    };\n\n        /** @type {jQuery} The jQuery node for the region. */\n        ActivityChooser.prototype.node = null;\n\n        return {\n            /**\n             * @param {String} region\n             *\n             * @return {ActivityChooser}\n             */\n            initActivityChooser: function (region) {\n                return new ActivityChooser(region);\n            }\n        };\n    }\n);"],"file":"activitychooser.min.js"}